<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIF Search</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h2 {
            text-align: center;
        }

        #searchContainer {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        #searchInput {
            padding: 10px;
            width: 60%;
            margin-right: 10px;
        }

        #searchButton {
            padding: 10px;
            cursor: pointer;
        }

        #gifGrid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 10px;
        }

        .gifImage {
            width: 100%;
            height: 100%;
            object-fit: cover;
            aspect-ratio: 1; /* Maintain 1:1 aspect ratio for each grid item */
            display: block;
        }
    </style>
</head>
<body>

    <h2>GIFs</h2>

    <div id="searchContainer">
        <input type="text" id="searchInput" placeholder="Enter search term">
        <button id="searchButton" onclick="performSearch()">Search</button>
    </div>
    
    <div id="gifGrid"></div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyA6Cs-jHl8cvDG2u5-vqIh8bNpmZOp86Oo",
          authDomain: "gif-loader-example.firebaseapp.com",
          projectId: "gif-loader-example",
          storageBucket: "gif-loader-example.appspot.com",
          messagingSenderId: "1030467425966",
          appId: "1:1030467425966:web:5cffaf0694f306ace03f3f",
          measurementId: "G-J2815L2HPX"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
    </script>  

    <script>
        // Function to get trending GIFs by default
        function getTrendingGifs() {
            var apiKey = "AIzaSyBp-TxEofbDdxmBa6T-MCyb6rDG4_NVknE"; // Replace with your API key
            var clientKey = "heatic-test-app"; // Replace with your client key
            var limit = 8;

            var trendingUrl = "https://tenor.googleapis.com/v2/featured?key=" + apiKey + "&client_key=" + clientKey + "&limit=" + limit;

            httpGetAsync(trendingUrl, tenorCallbackSearch);
        }

        // Function to perform search based on user input
        function performSearch() {
            var searchTerm = document.getElementById("searchInput").value;
            if (searchTerm.trim() !== "") {
                grabData(searchTerm);
            }
        }

        // Function to display GIFs on the page
        function displayGifs(gifs) {
            var gifGrid = document.getElementById("gifGrid");
            gifGrid.innerHTML = ""; // Clear previous results

            gifs.forEach(function (gif) {
                var gifImage = document.createElement("img");
                gifImage.src = gif["media_formats"]["gif"]["url"]; //if you use nanogif instead of gif it will load faster
                gifImage.alt = "GIF";
                gifImage.className = "gifImage";
                gifGrid.appendChild(gifImage);
            });
        }

        // Callback function for handling API response
        function tenorCallbackSearch(responseText) {
            var responseObjects = JSON.parse(responseText);
            var topGifs = responseObjects["results"];
            displayGifs(topGifs);
        }

        // Function to make an asynchronous GET request
        function httpGetAsync(theUrl, callback) {
            var xmlHttp = new XMLHttpRequest();

            xmlHttp.onreadystatechange = function () {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
                    callback(xmlHttp.responseText);
                }
            }

            xmlHttp.open("GET", theUrl, true);
            xmlHttp.send(null);
        }

        // Function to fetch GIFs based on the search term
        function grabData(searchTerm) {
            var apiKey = "AIzaSyBp-TxEofbDdxmBa6T-MCyb6rDG4_NVknE"; // Replace with your API key
            var clientKey = "heatic-test-app"; // Replace with your client key
            var limit = 8;

            var searchUrl = "https://tenor.googleapis.com/v2/search?q=" + searchTerm +
                "&key=" + apiKey + "&client_key=" + clientKey + "&limit=" + limit;

            httpGetAsync(searchUrl, tenorCallbackSearch);
        }

        // Load trending GIFs by default when the page loads
        window.onload = function () {
            getTrendingGifs();
        };
    </script>

</body>
</html>
